<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script>
    // https://viacep.com.br/exemplo/javascript/
    function limpaFormularioCep() {
      document.getElementById('logradouro').value=('');
      document.getElementById('numero').value=('');
      document.getElementById('complemento').value=('');
      document.getElementById('bairro').value=('');
      document.getElementById('cidade').value=('');
      document.getElementById('estado').value=('');
    }

    function meuCallback(conteudo) {
      if (!('erro' in conteudo)) {
        document.getElementById('logradouro').value=(conteudo.logradouro);
        document.getElementById('bairro').value=(conteudo.bairro);
        document.getElementById('cidade').value=(conteudo.localidade);
        document.getElementById('estado').value=(conteudo.uf);
      } else {
        limpaFormularioCep();
        alert('CEP não encontrado.');
      }
    }

    function pesquisaCep(valor) {
      var cep = valor.replace(/\D/g, '');

      if (cep != '') {
        var validacep = /^[0-9]{8}$/;

        if(validacep.test(cep)) {
          var script = document.createElement('script');

          script.src = 'https://viacep.com.br/ws/' + cep + '/json/?callback=meuCallback';

          document.body.appendChild(script);
        } else {
          limpaFormularioCep();
          alert('Formato de CEP inválido.');
        }
      } else {
        limpaFormularioCep();
      }
    };
  </script>
  <title>Cadastro de Clientes</title>
</head>
<body>
  <h1>Cadastro de Clientes</h1>
  <form action="/clientes/salvar" method="POST">
    {{csrfField()}}
    <label for="nome">Nome:</label>
    <input type="text" name="nome" id="nome">

    <br />
    <br />

    <label for="cpf">CPF:</label>
    <input type="text" name="cpf" id="cpf">

    <br />
    <br />

    <label for="email">E-mail:</label>
    <input type="text" name="email" id="email">

    <br />
    <br />

    <label for="tel_celular">Tel. Celular:</label>
    <input type="text" name="tel_celular" id="tel_celular">

    <br />
    <br />

    <label for="tel_fixo">Tel. Fixo:</label>
    <input type="text" name="tel_fixo" id="tel_fixo">

    <br />
    <br />

    <label for="cep">CEP:</label>
    <input type="text" name="cep" id="cep" maxlength="8" onblur="pesquisaCep(this.value);">

    <br />
    <br />

    <label for="logradouro">Logradouro:</label>
    <input type="text" name="logradouro" id="logradouro" disabled>

    <br />
    <br />

    <label for="numero">Número:</label>
    <input type="text" name="numero" id="numero">

    <br />
    <br />

    <label for="complemento">Complemento:</label>
    <input type="text" name="complemento" id="complemento">

    <br />
    <br />

    <label for="bairro">Bairro:</label>
    <input type="text" name="bairro" id="bairro" disabled>

    <br />
    <br />

    <label for="cidade">Cidade:</label>
    <input type="text" name="cidade" id="cidade" disabled>

    <br />
    <br />

    <label for="estado">UF:</label>
    <input type="text" name="estado" id="estado" max="2" disabled>

    <br />
    <br />

    <button type="submit">
        <span>Cadastrar</span>
    </button>
    <button type="reset">
        <span>Limpar</span>
    </button>
  </form>
</body>
</html>
